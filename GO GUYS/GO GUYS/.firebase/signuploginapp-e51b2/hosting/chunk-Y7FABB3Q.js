import{Ja as c,Ma as h,e as n,m as u,p as i,wa as o}from"./chunk-RUZQDE4M.js";import{d as t}from"./chunk-U3NIYLHF.js";var y=(()=>{class a{constructor(e,r,s){this.auth=e,this.firestore=r,this.router=s}isAuthenticated(){return this.auth.authState.pipe(n(e=>!!e))}login(e,r){return t(this,null,function*(){try{let s=yield this.auth.signInWithEmailAndPassword(e,r);return s.user?s.user.emailVerified?{success:!0,message:"Login successful"}:(yield s.user.sendEmailVerification(),yield this.auth.signOut(),{success:!1,message:"Email not verified. Verification email sent."}):{success:!1,message:"Login failed. Please try again."}}catch(s){return{success:!1,message:this.getAuthErrorMessage(s)}}})}resendVerificationEmail(){return t(this,null,function*(){try{let e=yield this.auth.currentUser;return e?(yield e.sendEmailVerification(),{success:!0,message:"Verification email sent successfully!"}):{success:!1,message:"No user is currently logged in."}}catch(e){return{success:!1,message:this.getAuthErrorMessage(e)}}})}resetPassword(e){return t(this,null,function*(){try{return yield this.auth.sendPasswordResetEmail(e),{success:!0,message:"Password reset email sent!"}}catch(r){return{success:!1,message:this.getAuthErrorMessage(r)}}})}getCurrentUser(){return t(this,null,function*(){return yield this.auth.currentUser})}logout(){return t(this,null,function*(){try{yield this.auth.signOut(),this.router.navigate(["/login"])}catch(e){console.error("Logout error:",e)}})}getAuthErrorMessage(e){switch(e.code){case"auth/invalid-credential":return"Incorrect email or password.";case"auth/user-not-found":return"No user found with this email.";case"auth/wrong-password":return"Wrong password. Please try again.";case"auth/too-many-requests":return"Too many failed attempts. Try again later.";case"auth/requires-recent-login":return"This action requires you to log in again.";default:return"An error occurred. Please try again."}}static{this.\u0275fac=function(r){return new(r||a)(i(c),i(h),i(o))}}static{this.\u0275prov=u({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();export{y as a};
